
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>ニュース電光掲示板（全画面対応）</title>
  <link href="https://fonts.googleapis.com/css2?family=DotGothic16&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      background-color: black;
      overflow: hidden;
    }
    #news-container {
      position: relative;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #news-wrapper {
      position: absolute;
      will-change: transform;
      white-space: nowrap;
    }
    #news-text {
      font-size: 50vh;
      color: orange;
      font-family: 'DotGothic16', monospace;
      text-shadow:
        0 0 5px orange,
        0 0 10px orange,
        0 0 20px red;
      line-height: 1;
    }
    .fullscreen-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 10px 16px;
      background: rgba(0,0,0,0.5);
      color: white;
      font-family: sans-serif;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
      cursor: pointer;
      z-index: 1000;
    }
    .fullscreen-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    .highlight {
      
  text-shadow:
        0 0 5px crimson,
        0 0 10px crimson,
        0 0 20px midiumvioretred;
      line-height: 1;
      color:red;
}
  </style>
</head>
<body>
  <div id="news-container">
    <div id="news-wrapper">
      <div id="news-text">読み込み中...</div>
    </div>
    <button class="fullscreen-btn" onclick="enterFullscreen()">全画面</button>
  </div>

  <script>

    function highlightKeywords(text) {
  const keywords = ["地震", "漏洩", "漏えい", "津波", "台風", "意識不明", "行方不明", "墜落", "テロ", "戦争", "核戦争", "死傷", "殺害", "倒壊", "台風", "速報", "台風", "冠水", "水没", "台風", "渋滞", "重体", "死亡", "事故", "警報", "避難"];
  keywords.forEach(word => {
    const re = new RegExp(word, "g");
    text = text.replace(re, `<span class="highlight">${word}</span>`);
  });
  return text;
}

    const endpoint = "/news";
    const scrollStep = 30;
    const fps = 10;
    const wrapper = document.getElementById("news-wrapper");
    const textEl = document.getElementById("news-text");

    let intervalId = null;

    function startScroll() {
      clearInterval(intervalId);
      let x = window.innerWidth;
      intervalId = setInterval(() => {
        const w = textEl.offsetWidth;
        x -= scrollStep;
        if (x < -w) x = window.innerWidth;
        wrapper.style.transform = `translateX(${x}px)`;
      }, 1000 / fps);
    }

    async function fetchNews() {
      try {
        const res = await fetch(endpoint);
        if (!res.ok) throw new Error("HTTPエラー: " + res.status);
        const data = await res.json();
        const headlines = data.map(item => item.title);
        const text = headlines.join("　　　　　");
        textEl.textContent = text;
        startScroll();
      } catch (e) {
        console.error("ニュース取得失敗:", e);
        textEl.textContent = "ニュースを取得できませんでした";
        startScroll();
      }
    }

    function enterFullscreen() {
      const el = document.body;
  if (el.requestFullscreen) {
    el.requestFullscreen();
  } else if (el.webkitRequestFullscreen) {
    el.webkitRequestFullscreen();
  } else if (el.msRequestFullscreen) {
    el.msRequestFullscreen();
  }
}

    fetchNews();
    setInterval(fetchNews, 10 * 60 * 1000);
  </script>
</body>
</html>
